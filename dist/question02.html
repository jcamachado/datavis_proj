<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>2- Músicas Lançadas no Mesmo Ano | Trabalho bonitao</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_observablehq/theme-air,near-midnight,alt,wide.css">
<link rel="preload" as="style" href="./_observablehq/stdlib/inputs.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_observablehq/theme-air,near-midnight,alt,wide.css">
<link rel="stylesheet" type="text/css" href="./_observablehq/stdlib/inputs.css">
<link rel="modulepreload" href="./_observablehq/client.js">
<link rel="modulepreload" href="./_observablehq/runtime.js">
<link rel="modulepreload" href="./_observablehq/stdlib.js">
<link rel="modulepreload" href="./_npm/d3-dsv@3.0.1/_esm.js">
<link rel="modulepreload" href="./_observablehq/stdlib/inputs.js">
<link rel="modulepreload" href="./_npm/@observablehq/plot@0.6.14/_esm.js">
<link rel="modulepreload" href="./_npm/htl@0.3.1/_esm.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3@7.9.0/_esm.js">
<link rel="modulepreload" href="./_npm/interval-tree-1d@1.0.4/_esm.js">
<link rel="modulepreload" href="./_npm/d3-array@3.2.4/_esm.js">
<link rel="modulepreload" href="./_npm/d3-axis@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-brush@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-chord@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-color@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-contour@4.0.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-delaunay@6.0.4/_esm.js">
<link rel="modulepreload" href="./_npm/d3-dispatch@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-drag@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-ease@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-fetch@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-force@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-format@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-geo@3.1.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-hierarchy@3.1.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-interpolate@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-path@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-polygon@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-quadtree@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-random@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-scale@4.0.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-scale-chromatic@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-selection@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-shape@3.2.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-time@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-time-format@4.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-timer@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-transition@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-zoom@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/binary-search-bounds@2.0.5/_esm.js">
<link rel="modulepreload" href="./_npm/internmap@2.0.3/_esm.js">
<link rel="modulepreload" href="./_npm/delaunator@5.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/robust-predicates@3.0.2/_esm.js">
<link rel="icon" href="./_file/spotify.ce4e959c.png" type="image/png" sizes="32x32">
<script type="module">

import {define} from "./_observablehq/client.js";
import {registerFile} from "./_observablehq/stdlib.js";

registerFile("./spotify-2023.csv", {"name":"./spotify-2023.csv","mimeType":"text/csv","path":"./_file/spotify-2023.db722c91.csv","lastModified":1715960036333});

define({id: "4c54cb97", inputs: ["FileAttachment"], outputs: ["Spotify"], body: async (FileAttachment) => {
let Spotify = await FileAttachment("./spotify-2023.csv").csv();

Spotify = Spotify
  .filter(d => !isNaN(Number(d.streams)))
  .map(d => ({ ...d, streams: Number(d.streams) }));
return {Spotify};
}});

define({id: "ad8921c7", inputs: ["Spotify"], outputs: ["uniqueReleasedYears"], body: (Spotify) => {
// O dataset já está com os streams como atributo numérico e em ordem decrescente
const uniqueReleasedYears = [...new Set(Spotify.map(d => d.released_year))];
uniqueReleasedYears.sort((a, b) => b - a);
return {uniqueReleasedYears};
}});

define({id: "ee19beaa", inputs: ["view","Inputs","uniqueReleasedYears"], outputs: ["range"], body: (view,Inputs,uniqueReleasedYears) => {
let range = view(Inputs.select(uniqueReleasedYears, {label: "Ano de Lançamento: "}));
return {range};
}});

define({id: "382cc2e5", inputs: ["Spotify","range"], outputs: ["filterByYear","songsFromSpecificYear"], body: (Spotify,range) => {
// Filtrando por ano
function filterByYear(data, year) {
  return data.filter(d => d.released_year === year);
}

// Use a função para criar um novo conjunto de dados
let songsFromSpecificYear = filterByYear(Spotify, range); // Substitua 2023 pelo ano desejado
//display(songsFromSpecificYear)
return {filterByYear,songsFromSpecificYear};
}});

define({id: "ee3d6c2e", inputs: ["songsFromSpecificYear"], outputs: ["artistCounts","artistCount"], body: async (songsFromSpecificYear) => {
async function artistCounts(data) {

  // Separando os artistas para contabilizar os streams individualmente
  const expandedArtists = data.flatMap(d => 
    d['artist(s)_name'].split(', ').map(artist => ({
    artist: artist,
    streams_in_millions: (d['streams']/ 1000000)
    }))
  );
  const artistStreams = {}
  expandedArtists.forEach(artistData => {
  // Verifica se o artista já existe no objeto
    if (artistStreams.hasOwnProperty(artistData.artist)) {
      // Se já existe, soma os streams
      artistStreams[artistData.artist] += artistData.streams_in_millions;
    } else {
      // Se não existe, inicializa com o valor atual
      artistStreams[artistData.artist] = artistData.streams_in_millions;
    }
  })
  const artistArray = Object.entries(artistStreams).map(([artist, streams]) => {
    return {artist, streams};
  });
  artistArray.sort((a, b) => b.streams - a.streams);
return artistArray
};
const artistCount = await artistCounts(songsFromSpecificYear);
//view(Inputs.table(artistCount))
return {artistCounts,artistCount};
}});

define({id: "9ea9937c", inputs: ["Plot"], outputs: ["generateBarPlot"], body: (Plot) => {
function generateBarPlot(data, xColumn, yColumn) {
  return Plot.plot({
    marginLeft: 0,
    marginRight: 0,
    x: { label: "Streams (M)", tickColor: 'black' },
    y: { label: "Artistas", axis: null},
    marks: [
      Plot.barX(data, {
        x: xColumn,
        y: yColumn,
        sort: { y: "x", reverse: true, limit: 10 }
      }),

     Plot.text(data, {
        fontSize: 10,
        text: d => `${Math.floor(d[xColumn])} M`,
        y: yColumn,
        x: xColumn,
        textAnchor: "end",
        dx: -3,
        fill: "black"
      }),

      Plot.text(data, {
        fontSize: 10,
        text: d => d[yColumn],
        y: yColumn,
        x: 0,
        textAnchor: "start",
        dx: 3,
        fill: "black"
      })
    ]
  });
}
return {generateBarPlot};
}});

define({id: "3c7502e1", inline: true, inputs: ["resize","generateBarPlot","artistCount","display"], body: async (resize,generateBarPlot,artistCount,display) => {
display(await(
resize((width) => generateBarPlot(artistCount, "streams", "artist"))
))
}});

define({id: "47ca49c2", inputs: ["songsFromSpecificYear"], outputs: ["trackCounts","trackCount"], body: async (songsFromSpecificYear) => {
function trackCounts(dataset) {
  return dataset.map(item => {
    return {
      track_name: item.track_name,
      streams: item.streams / 1e6,
      'artist(s)_name': item['artist(s)_name']
    };
  });
};

let trackCount = await trackCounts(songsFromSpecificYear);
trackCount.sort((a, b) => b.streams - a.streams);
//display(trackCount)
//view(Inputs.table(trackCount))
return {trackCounts,trackCount};
}});

define({id: "1b8b22bb", inputs: ["Plot"], outputs: ["generateBarPlot02"], body: (Plot) => {
function generateBarPlot02(data, xColumn, yColumn) {
  let maxStreams = Math.max(...data.map(d => d[xColumn]));
  return Plot.plot({
    marginLeft: 0,
    marginRight: 0,
    x: { label: "Streams (M)", tickColor: 'black' },
    y: { label: "Artistas", axis: null},
    marks: [
      Plot.barX(data, {
        x: xColumn,
        y: yColumn,
        sort: { y: null },
        title: d => `${d[yColumn]} by ${d["artist(s)_name"]}`
}),

     Plot.text(data, {
        fontSize: 10,
        text: d => `${Math.floor(d[xColumn])} M`,
        y: yColumn,
        x: xColumn,
        textAnchor: "end",
        dx: -3,
        fill: "black"
      }),
      
      Plot.text(data, {
        fontSize: 10,        
        text: d => {
          // Calcule a proporção de streams para esta instância em relação ao máximo
          let proportion = d[xColumn] / maxStreams;

          // Use essa proporção para calcular o número de caracteres a exibir
          let numChars = Math.floor(proportion * 35); // Ajuste o valor 100 conforme necessário

          // Retorne a substring
          return `${d[yColumn].substring(0, numChars)} by ${d["artist(s)_name"].substring(0, numChars)}`;
        },
        y: yColumn,
        x: 0,
        textAnchor: "start",
        dx: 3,
        fill: "black"
      })
    ]
  });
}
return {generateBarPlot02};
}});

define({id: "150cf1ce", inline: true, inputs: ["resize","generateBarPlot02","trackCount","display"], body: async (resize,generateBarPlot02,trackCount,display) => {
display(await(
resize((width) => generateBarPlot02(trackCount.slice(0,10), "streams", "track_name"))
))
}});

define({id: "f0c4fbac", inputs: ["generateBarPlot","artistCount","generateBarPlot02","trackCount"], outputs: ["plot1","plot2"], body: (generateBarPlot,artistCount,generateBarPlot02,trackCount) => {
// Concatena os gráficos horizontalmente
let plot1 = generateBarPlot(artistCount, "streams", "artist");
let plot2 = generateBarPlot02(trackCount.slice(0,10), "streams", "track_name");

return {plot1,plot2};
}});

</script>
<input id="observablehq-sidebar-toggle" type="checkbox" title="Toggle sidebar">
<label id="observablehq-sidebar-backdrop" for="observablehq-sidebar-toggle"></label>
<nav id="observablehq-sidebar">
  <ol>
    <label id="observablehq-sidebar-close" for="observablehq-sidebar-toggle"></label>
    <li class="observablehq-link"><a href="./">Trabalho bonitao</a></li>
  </ol>
  <ol>
    <li class="observablehq-link"><a href="./question01">1- Analisando os sucessos</a></li>
    <li class="observablehq-link observablehq-link-active"><a href="./question02">2- Músicas Lançadas no Mesmo Ano</a></li>
    <li class="observablehq-link"><a href="./question03">3- Plataformas Musicais</a></li>
  </ol>
</nav>
<script>{Object.assign(document.createElement("a"),{href:""}).password&&location.replace(location.href);const e=document.querySelector("#observablehq-sidebar"),t=document.querySelector("#observablehq-sidebar-toggle"),r=sessionStorage.getItem("observablehq-sidebar");r?t.checked=r==="true":t.indeterminate=!0;for(const o of document.querySelectorAll("#observablehq-sidebar summary")){const s=o.parentElement;switch(sessionStorage.getItem(`observablehq-sidebar:${o.textContent}`)){case"true":s.open=!0;break;case"false":s.classList.contains("observablehq-section-active")||(s.open=!1);break}}addEventListener("beforeunload",()=>sessionStorage.setItem("observablehq-sidebar-scrolly",`${e.scrollTop}`));const a=sessionStorage.getItem("observablehq-sidebar-scrolly");a!=null&&(e.style.cssText="overflow: hidden;",e.scrollTop=+a,e.style.cssText="");}</script>
<aside id="observablehq-toc" data-selector="h1:not(:first-of-type), h2:first-child, :not(h1) + h2">
<nav>
<div>Contents</div>
<ol>
<li class="observablehq-secondary-link"><a href="#top-10-artistas-por-ano-de-lan%C3%A7amento">Top 10 Artistas por Ano de Lançamento</a></li>
<li class="observablehq-secondary-link"><a href="#top-10-m%C3%BAsicas-por-ano-de-lan%C3%A7amento">Top 10 Músicas por Ano de Lançamento</a></li>
</ol>
</nav>
</aside>
<div id="observablehq-center">
<main id="observablehq-main" class="observablehq">
<h1 id="an%C3%A1lise-da-varia%C3%A7%C3%A3o-do-conjunto-das-top-10-m%C3%BAsicas-e-artistas-por-ano-de-lan%C3%A7amento" tabindex="-1"><a class="observablehq-header-anchor" href="#an%C3%A1lise-da-varia%C3%A7%C3%A3o-do-conjunto-das-top-10-m%C3%BAsicas-e-artistas-por-ano-de-lan%C3%A7amento">Análise da Variação do Conjunto das Top 10 Músicas e Artistas por Ano de Lançamento</a></h1>
<p style="text-align:justify;">
Para observar a variação das Top 10 músicas e artistas de acordo com o ano de lançamento das músicas, o dataset foi agrupado por ano de lançamento das músicas para a primeira tabela, e posteriormente por artistas para a segunda. Para contabilizar os artistas, somamos o número de streams de cada música em que o artista aparece, incluindo as colaborações ("feats"). Optamos por utilizar gráficos de barras porque este tipo de visualização facilita a comparação entre os números de streams de cada item. As barras proporcionam uma maneira clara e visualmente intuitiva de comparar a  popularidade dos dados no contexto anual. Na primeira tabela, cada barra representa uma música enquanto na segunda, ela representa um artista.
</p>
<p style="text-align:justify;">
A análise dos dados de reprodução das músicas no Spotify revela que o conjunto dos Top 10 artistas, apesar de mudanças, apresenta alguma estabilidade de popularidade ao longo dos anos. Por exemplo, em 2020, 3 artistas continuaram no Top 10 em comparação com 2019.
</p>
<p style="text-align:justify;">
Considerando músicas lançadas em anos muito anteriores a 2023, os artistas que aparecem no Top 10 são frequentemente os mesmos que estão no Top 10 de canções. Nos anos mais recentes, existem músicas, embora poucas, muito populares cujos artistas não estão entre os mais tocados no Top 10, pois a contabilização dos artistas mais tocados inclui suas parcerias e muitas destas músicas feitas em parceria não alcançam o Top 10.
</p>
<div id="cell-4c54cb97" class="observablehq observablehq--block"></div>
<div id="cell-ad8921c7" class="observablehq observablehq--block"></div>
<div id="cell-ee19beaa" class="observablehq observablehq--block"></div>
<div id="cell-382cc2e5" class="observablehq observablehq--block"></div>
<div id="cell-ee3d6c2e" class="observablehq observablehq--block"></div>
<div id="cell-9ea9937c" class="observablehq observablehq--block"></div>
<h2 id="top-10-artistas-por-ano-de-lan%C3%A7amento" tabindex="-1"><a class="observablehq-header-anchor" href="#top-10-artistas-por-ano-de-lan%C3%A7amento">Top 10 Artistas por Ano de Lançamento</a></h2>
<div class="grid grid-cols-1">
  <div class="card">
    <span id="cell-3c7502e1" class="observablehq--loading"></span>
  </div>
</div>
<div id="cell-47ca49c2" class="observablehq observablehq--block"></div>
<div id="cell-1b8b22bb" class="observablehq observablehq--block"></div>
<h2 id="top-10-m%C3%BAsicas-por-ano-de-lan%C3%A7amento" tabindex="-1"><a class="observablehq-header-anchor" href="#top-10-m%C3%BAsicas-por-ano-de-lan%C3%A7amento">Top 10 Músicas por Ano de Lançamento</a></h2>
<div class="grid grid-cols-1">
  <div class="card">
    <span id="cell-150cf1ce" class="observablehq--loading"></span>
  </div>
</div>
<div id="cell-f0c4fbac" class="observablehq observablehq--block"></div>
</main>
<footer id="observablehq-footer">
<nav><a rel="prev" href="./question01"><span>1- Analisando os sucessos</span></a><a rel="next" href="./question03"><span>3- Plataformas Musicais</span></a></nav>
<div>Built with <a href="https://observablehq.com/" target="_blank" rel="noopener noreferrer">Observable</a> on <a title="2024-05-17T17:56:36">May 17, 2024</a>.</div>
</footer>
</div>
